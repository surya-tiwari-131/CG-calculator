<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVNIT SGPA Analyzer | Designed by Surya</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;900&display=swap');
        
        :root {
            --emerald-glow: rgba(16, 185, 129, 0.15);
            --nature-bg: #f8fafc;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--nature-bg);
            background-image: 
                radial-gradient(at 0% 0%, rgba(16, 185, 129, 0.08) 0px, transparent 50%),
                radial-gradient(at 100% 0%, rgba(59, 130, 246, 0.08) 0px, transparent 50%);
            min-height: 100vh;
            color: #1e293b;
        }

        /* Surya Badge - Premium Highlighting */
        .surya-badge {
            background: white;
            border: 2px solid #10b981;
            box-shadow: 0 10px 25px -5px var(--emerald-glow);
            transition: all 0.3s ease;
            cursor: default;
        }
        
        .surya-badge:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 30px -5px rgba(16, 185, 129, 0.3);
        }

        .nature-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 28px;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .nature-card:hover {
            border-color: #10b981;
            transform: translateY(-8px);
            box-shadow: 0 25px 50px -12px rgba(16, 185, 129, 0.12);
        }

        .btn-calculate {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            box-shadow: 0 12px 24px -6px rgba(16, 185, 129, 0.4);
        }

        .btn-ai {
            background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
        }

        .sgpa-text {
            background: linear-gradient(135deg, #0f172a 0%, #334155 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: clamp(5rem, 15vw, 10rem);
        }

        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2310b981'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1.25rem;
        }

        .loader {
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-top: 3px solid #ffffff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Grid circuit background */
        .circuit-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: radial-gradient(#10b981 0.5px, transparent 0.5px);
            background-size: 30px 30px;
            opacity: 0.05;
            z-index: -1;
        }
    </style>
</head>
<body class="py-10 px-4 md:py-20">
    <div class="circuit-overlay"></div>

    <div class="max-w-5xl mx-auto">
        <!-- Prominent Attribution -->
        <div class="flex justify-center mb-12">
            <div class="surya-badge px-10 py-3 rounded-full inline-flex items-center gap-4">
                <span class="relative flex h-3 w-3">
                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-3 w-3 bg-emerald-500"></span>
                </span>
                <span class="text-sm md:text-base font-black uppercase tracking-[0.4em] text-emerald-800">Designed by Surya</span>
            </div>
        </div>

        <div class="bg-white/40 backdrop-blur-xl border border-white/50 rounded-[3.5rem] p-8 md:p-16 shadow-2xl">
            <header class="text-center mb-16">
                <div class="inline-block px-5 py-2 bg-emerald-50 text-emerald-700 text-[11px] font-black uppercase tracking-[0.2em] rounded-full mb-6 border border-emerald-100">
                    SVNIT Surat • Dept. of Electrical Engineering
                </div>
                <h1 class="text-5xl md:text-7xl font-black text-slate-900 tracking-tighter leading-tight">
                    Academic <span class="text-emerald-500 italic">Console</span>
                </h1>
                <p class="text-slate-500 mt-4 text-xs md:text-base font-bold uppercase tracking-[0.3em] opacity-60">First Semester SGPA/CGPA Analysis</p>
            </header>

            <!-- API Configuration (For GitHub Compatibility) -->
            <div class="flex justify-end mb-6">
                <button onclick="document.getElementById('api-modal').classList.toggle('hidden')" class="text-[10px] font-black text-slate-400 hover:text-emerald-500 transition-colors uppercase tracking-widest flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                    AI Engine Config
                </button>
            </div>
            
            <div id="api-modal" class="hidden mb-10 p-6 bg-emerald-50/50 border border-emerald-100 rounded-3xl">
                <label class="block text-[10px] font-black text-emerald-800 uppercase tracking-widest mb-3">Gemini Pro API Key (for Diagnostics)</label>
                <input type="password" id="custom-api-key" placeholder="PASTE_YOUR_GEMINI_API_KEY_HERE" class="w-full p-4 bg-white border border-emerald-200 rounded-2xl outline-none focus:ring-2 focus:ring-emerald-500 transition-all font-mono text-xs">
                <p class="text-[9px] text-emerald-600/60 mt-2 font-bold uppercase tracking-tighter italic">*Required if hosting on GitHub Pages</p>
            </div>

            <div id="calculator-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-16">
                <!-- Subject Cards -->
                <div class="nature-card p-8">
                    <h3 class="font-black text-slate-800 text-lg uppercase tracking-tight mb-6 flex items-center gap-3">
                        <span class="w-2 h-6 bg-emerald-500 rounded-full"></span> BEE (EE101)
                    </h3>
                    <div class="space-y-6">
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest block">Theory Grade (4 Cr)</label>
                            <select id="bee_t" class="grade-input w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:border-emerald-500 font-bold transition-all" data-credits="4">
                                <option value="10">AA</option><option value="9">AB</option><option value="8" selected>BB</option><option value="7">BC</option><option value="6">CC</option><option value="5">CD</option><option value="4">DD</option><option value="0">FF</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest block">Practical Grade (1 Cr)</label>
                            <select id="bee_p" class="grade-input w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:border-emerald-500 font-bold transition-all" data-credits="1">
                                <option value="10">AA</option><option value="9" selected>AB</option><option value="8">BB</option><option value="7">BC</option><option value="6">CC</option><option value="5">CD</option><option value="4">DD</option><option value="0">FF</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="nature-card p-8">
                    <h3 class="font-black text-slate-800 text-lg uppercase tracking-tight mb-6 flex items-center gap-3">
                        <span class="w-2 h-6 bg-emerald-500 rounded-full"></span> Drawing (ME110)
                    </h3>
                    <div class="space-y-6">
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest block">Theory Grade (2 Cr)</label>
                            <select id="ed_t" class="grade-input w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:border-emerald-500 font-bold transition-all" data-credits="2">
                                <option value="10">AA</option><option value="9">AB</option><option value="8" selected>BB</option><option value="7">BC</option><option value="6">CC</option><option value="5">CD</option><option value="4">DD</option><option value="0">FF</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest block">Practical Grade (2 Cr)</label>
                            <select id="ed_p" class="grade-input w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:border-emerald-500 font-bold transition-all" data-credits="2">
                                <option value="10" selected>AA</option><option value="9">AB</option><option value="8">BB</option><option value="7">BC</option><option value="6">CC</option><option value="5">CD</option><option value="4">DD</option><option value="0">FF</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="nature-card p-8">
                    <h3 class="font-black text-slate-800 text-lg uppercase tracking-tight mb-6 flex items-center gap-3">
                        <span class="w-2 h-6 bg-emerald-500 rounded-full"></span> Physics (PH109)
                    </h3>
                    <div class="space-y-6">
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest block">Theory Grade (3 Cr)</label>
                            <select id="ph_t" class="grade-input w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:border-emerald-500 font-bold transition-all" data-credits="3">
                                <option value="10" selected>AA</option><option value="9">AB</option><option value="8">BB</option><option value="7">BC</option><option value="6">CC</option><option value="5">CD</option><option value="4">DD</option><option value="0">FF</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest block">Practical Grade (1 Cr)</label>
                            <select id="ph_p" class="grade-input w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:border-emerald-500 font-bold transition-all" data-credits="1">
                                <option value="10" selected>AA</option><option value="9">AB</option><option value="8">BB</option><option value="7">BC</option><option value="6">CC</option><option value="5">CD</option><option value="4">DD</option><option value="0">FF</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="nature-card p-8">
                    <h3 class="font-black text-slate-800 text-lg uppercase tracking-tight mb-6 flex items-center gap-3">
                        <span class="w-2 h-6 bg-emerald-500 rounded-full"></span> Core Subjects
                    </h3>
                    <div class="space-y-6">
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest block">Mathematics-I (4 Cr)</label>
                            <select id="ma_t" class="grade-input w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:border-emerald-500 font-bold transition-all" data-credits="4">
                                <option value="10">AA</option><option value="9">AB</option><option value="8" selected>BB</option><option value="7">BC</option><option value="6">CC</option><option value="5">CD</option><option value="4">DD</option><option value="0">FF</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest block">English / EPC (4 Cr)</label>
                            <select id="hs_t" class="grade-input w-full p-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:border-emerald-500 font-bold transition-all" data-credits="4">
                                <option value="10">AA</option><option value="9">AB</option><option value="8">BB</option><option value="7" selected>BC</option><option value="6">CC</option><option value="5">CD</option><option value="4">DD</option><option value="0">FF</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center">
                <button id="calculate-btn" class="btn-calculate text-white font-black py-6 px-20 rounded-3xl text-xl tracking-[0.2em] uppercase transition-all hover:scale-105 active:scale-95 shadow-xl">
                    Run Calculation
                </button>
            </div>

            <!-- Result Interface -->
            <div id="result-card" class="hidden mt-20 p-12 md:p-20 border-2 border-emerald-500 bg-white rounded-[4rem] text-center shadow-2xl animate-in zoom-in duration-500">
                <h3 class="text-emerald-600 font-black uppercase tracking-[0.6em] text-sm mb-6">Aggregated SGPA</h3>
                <div id="sgpa-display" class="sgpa-text font-black tracking-tighter my-10">0.00</div>
                <p id="performance-msg" class="text-2xl font-bold text-slate-600 mb-12 italic"></p>
                
                <button id="ai-insights-btn" class="btn-ai text-white font-black py-5 px-10 rounded-2xl flex items-center gap-4 mx-auto transition-all hover:shadow-2xl active:scale-95">
                    <span class="tracking-widest uppercase text-sm">✨ Neural Roadmap Diagnostic</span>
                    <div id="ai-loader" class="loader hidden"></div>
                </button>
            </div>

            <!-- AI Insight Panel -->
            <div id="ai-insights-container" class="hidden mt-12 nature-card p-10 md:p-16 border-blue-100 bg-blue-50/20 animate-in slide-in-from-bottom-10 duration-700">
                <div class="flex items-center gap-6 mb-10">
                    <div class="w-16 h-16 bg-blue-100 rounded-3xl flex items-center justify-center text-blue-600 shadow-xl">
                        <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
                    </div>
                    <div>
                        <h3 class="font-black text-3xl text-blue-900 tracking-tighter">Diagnostic Roadmap</h3>
                        <p class="text-[10px] font-black text-blue-400 uppercase tracking-widest">Neural Analysis Engine Active</p>
                    </div>
                </div>
                <div id="ai-response-text" class="text-slate-700 space-y-6 leading-relaxed text-lg font-medium">
                    <!-- AI Content -->
                </div>
            </div>

            <footer class="mt-24 pt-10 border-t border-slate-100 flex flex-col md:flex-row justify-between items-center gap-6">
                <p class="text-[10px] text-slate-400 font-black uppercase tracking-[0.4em]">SVNIT • Electrical Dept 2024</p>
                <div class="text-[11px] font-black text-emerald-600 uppercase tracking-widest bg-emerald-50 px-5 py-2 rounded-xl">
                    Architect: Suryaprakash Tiwari
                </div>
            </footer>
        </div>
    </div>

    <script>
        const apiKey = ""; // Provided by environment at runtime or custom key input

        async function fetchGemini(userQuery, systemPrompt) {
            const customKey = document.getElementById('custom-api-key').value;
            const activeKey = apiKey || customKey;
            
            if (!activeKey) {
                alert("Please enter a Gemini API Key in the 'AI Engine Config' section to enable diagnostics on GitHub.");
                return null;
            }

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${activeKey}`;
            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] }
            };

            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (response.ok) return await response.json();
                } catch (e) {}
                await new Promise(r => setTimeout(r, Math.pow(2, i) * 1000));
            }
            throw new Error('Neural response failure.');
        }

        async function getAIInsights(grades, sgpa) {
            const aiBtn = document.getElementById('ai-insights-btn');
            const aiLoader = document.getElementById('ai-loader');
            const container = document.getElementById('ai-insights-container');
            const responseText = document.getElementById('ai-response-text');

            aiBtn.disabled = true;
            aiLoader.classList.remove('hidden');
            
            const systemPrompt = "You are a senior mentor at SVNIT Surat Electrical Engineering. Analyze 1st-sem grades and map a technical strategy for 2nd-sem core courses (Circuits EE102, Electronics EC108, Programming CS110, Maths-II MA114). Use specific SVNIT curriculum references and a professional engineer tone.";
            const userQuery = `SGPA: ${sgpa}. Grades: BEE(${grades.bee_t}/${grades.bee_p}), Physics(${grades.ph_t}/${grades.ph_p}), ED(${grades.ed_t}/${grades.ed_p}), Maths(${grades.ma_t}), English(${grades.hs_t}). Provide a 3-point Roadmap Diagnostic.`;

            try {
                const data = await fetchGemini(userQuery, systemPrompt);
                if (!data) return;
                
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "Diagnostic data unavailable.";
                
                container.classList.remove('hidden');
                responseText.innerHTML = text
                    .replace(/\n\n/g, '<br><br>')
                    .replace(/\* \*\*(.*?)\*\*/g, '<br>• <strong class="text-blue-800">$1</strong>')
                    .replace(/\* (.*?)/g, '• $1');

                container.scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                responseText.innerHTML = "<span class='text-red-500 font-black tracking-widest uppercase'>ENGINE ERROR: Unable to synchronize with Neural Engine. Verify API Key.</span>";
                container.classList.remove('hidden');
            } finally {
                aiBtn.disabled = false;
                aiLoader.classList.add('hidden');
            }
        }

        document.getElementById('calculate-btn').addEventListener('click', function() {
            const gradeInputs = document.querySelectorAll('.grade-input');
            let totalPoints = 0;
            let totalCredits = 0;

            gradeInputs.forEach(input => {
                totalPoints += (parseFloat(input.value) * parseFloat(input.getAttribute('data-credits')));
                totalCredits += parseFloat(input.getAttribute('data-credits'));
            });

            const sgpa = (totalPoints / totalCredits).toFixed(2);
            const resultCard = document.getElementById('result-card');
            const sgpaDisplay = document.getElementById('sgpa-display');
            const msgDisplay = document.getElementById('performance-msg');
            
            resultCard.classList.remove('hidden');
            document.getElementById('ai-insights-container').classList.add('hidden');
            sgpaDisplay.textContent = sgpa;

            if (sgpa >= 9.5) msgDisplay.textContent = "PEAK PERFORMANCE / BATCH ELITE";
            else if (sgpa >= 8.5) msgDisplay.textContent = "STABLE FREQUENCY / HIGH EFFICIENCY";
            else if (sgpa >= 7.5) msgDisplay.textContent = "NOMINAL OUTPUT / FUNCTIONAL STATUS";
            else if (sgpa >= 6.0) msgDisplay.textContent = "MAINTENANCE REQUIRED / LOW FACTOR";
            else msgDisplay.textContent = "SYSTEM CRITICAL / REBOOT REQUIRED";

            resultCard.scrollIntoView({ behavior: 'smooth' });
        });

        document.getElementById('ai-insights-btn').addEventListener('click', function() {
            const getT = (id) => document.getElementById(id).options[document.getElementById(id).selectedIndex].text;
            const grades = {
                bee_t: getT('bee_t'), bee_p: getT('bee_p'),
                ed_t: getT('ed_t'), ed_p: getT('ed_p'),
                ph_t: getT('ph_t'), ph_p: getT('ph_p'),
                ma_t: getT('ma_t'), hs_t: getT('hs_t')
            };
            getAIInsights(grades, document.getElementById('sgpa-display').textContent);
        });
    </script>
</body>
</html>
